package Strategy;

import Client.Client;
import Exceptions.RequestException;
import Exceptions.RequestPASSException;
import Serveur.FtpRequest;

public class RequestPASS implements Request {

	public void doRequest(FtpRequest ftp, String[] request)
			throws RequestException {

		Client c = ftp.getClient();
		/* Test si l'usage est correct */
		if (request.length != 2) {
			ftp.getWriter().println("USAGE : PASS password");
		}
		/* Test si le client a déjà entré la commande USER */
		if (c == null)
			ftp.getWriter().println(
					"Veuillez d'abord vous connecter avec la commande USER");
		/* Test si le mot de pass correspond au client */
		if (ftp.getClient().isPassword(request[1])) {
			ftp.getWriter().println(230 + " Password ok");
			ftp.getClient().setConnected(true);
			System.out.println(ftp.getClient() + " est connecté.");
		} else {
			throw new RequestPASSException(ftp);
		}
	}

}
