package Stategy;

import static org.mockito.Mockito.mock;

import org.junit.Test;
import org.mockito.Mockito;

import Client.Client;
import Serveur.FtpRequest;
import Strategy.Request;

public class RequestPASSTest {

	@Test
	public void testPASSok() {
		FtpRequest ftp = mock(FtpRequest.class);
		String [] request = {"PASS", "123"}
		Client c = mock(Client.class);
		
		Mockito.when(ftp.getClient()).thenReturn(c);
		Mockito.when(c.isPassword("111")).thenReturn(true);

		RequestPASS pass = new RequestPASS();

		pass.doRequest(ftp);

		Mockito.verify(session).sendCommand("230 User logged in, proceed");
	}
	
	@Test
	public void testPASSko() {
		Session session = mock(Session.class);
		Request req = mock(Request.class);
		User user = mock(User.class);
		
		Mockito.when(req.getSession()).thenReturn(session);
		Mockito.when(session.getUser()).thenReturn(user);
		Mockito.when(req.getArgument()).thenReturn("azerty");
		Mockito.when(user.connect("azerty")).thenReturn(false);

		PASS pass = new PASS();

		pass.execute(req);

		Mockito.verify(session).sendCommand("530 Not logged in");
	}

}
